# 🌍 UI Localizer - 本地化审计助手

> 多语言游戏 UI 本地化智能审计工具，支持截图分析和进化学习

**2月14日更新内容**：
- 增加防 AI 幻觉功能，优化提示词
- 增加视频时长自检测功能，需要额外安装库：`pip install opencv-python`
- 增加模式选择的选项：标准（同原有）、高密度模式（分段处理5分钟以下视频，输出更全面）

**2月13日更新**：v15.0 支持选择多语言（英德法土西葡俄日韩）

---

## ✨ 功能特性

- 🌐 **多语言支持** - 支持 9 种目标语言：英语、德语、法语、土耳其语、西班牙语、葡萄牙语、俄语、日语、韩语
- 🤖 **AI 驱动** - 基于 Google Gemini 的多模态视觉能力进行本地化质量分析
- 📸 **截图分析** - 支持 UI 截图和视频上传，自动识别截断、重叠、拼写错误等问题
- 🧠 **进化记忆** - 自动学习和记忆历史审计结果，支持用户"调教"AI，持续优化
- 📚 **术语管理** - 内置术语表支持，确保翻译一致性
- 📊 **批量处理** - 支持大规模本地化文件批量审计
- 🎯 **精准分类** - 智能分类问题类型：
  - [Truncation] - 文本截断/重叠
  - [Untranslated] - 未翻译文本
  - [Grammar/Spelling] - 语法拼写错误
  - [Style/Tone] - 风格/语气不当（包括中式英语 Chinglish）
  - [Consistency] - 术语不一致

---

## 📝 简介

本工具利用 AI 模型，通过多模态视觉能力，对游戏/应用的录屏视频进行逐帧审计。它能自动识别 UI 溢出、拼写错误、中式英语（Chinglish）以及用词不当，并输出 Excel 可直接使用的格式，方便新游处理本地化翻译问题。

**推荐使用默认的 Flash 模型**，tokens 消耗最小 + 返回最快。

支持 45 分钟（2GB）以下的视频传输并生成分析。

**注意**：AI 识别并非全对，请使用的同学注意甄别，主观判断。

---

## 📦 准备工作

在使用之前，请确保你的电脑满足以下条件：

- **操作系统**：Windows 10/11 或 macOS
- **API Key**：你需要一个 Google AI Studio 的 API Key 👉 [点击这里免费申请](https://aistudio.google.com/app/apikey)
- **Python 环境**：电脑需安装 Python 3.10 或以上版本

---

## 🚀 安装步骤 (一次性设置)

### 第一步：安装 Python (如果已安装可跳过)

1. **下载 Python 安装包**：[官网下载链接](https://www.python.org/downloads/)
2. ⚠️ **关键步骤**：安装时务必勾选底部的 **"Add Python to PATH"** (将 Python 添加到环境变量)
3. 点击 "Install Now" 直到完成

### 第二步：下载工具文件

将 `ui_localizer.py` 文件保存在一个新建的文件夹中（例如桌面的 `AI_Audit_Tool` 文件夹）

### 第三步：安装依赖库

在该文件夹内，按住 `Shift` 键并点击鼠标右键，选择 "在此处打开 Powershell 窗口" 或 "在终端中打开"。

复制以下指令并粘贴到黑框中，按回车运行：

```bash
pip install customtkinter google-generativeai opencv-python pillow
```

---

## 📖 使用指南 (日常操作)

### 🚀 启动软件

**方法 A (推荐)**：在文件夹地址栏输入 `cmd` 回车，然后输入：
```bash
python ui_localizer.py
```

**方法 B (制作快捷方式)**：新建一个 `启动.bat` 文件，里面写上：
```bash
python ui_localizer.py
```
以后双击该 bat 文件即可运行。

### ⚙️ 界面配置

**输入 API Key**：
- 软件首次启动后，在顶部 "API Key" 输入框填入你的密钥
- 访问 https://aistudio.google.com/app/apikey 获取
- **注**：Key 会自动保存在本地 `config.json` 中，下次无需再次输入

**选择模型 (Model)**：

| 模型 | 特点 | 适用场景 |
|------|------|----------|
| `gemini-3-flash-preview` | ⚡ 速度最快 | 适合快速过一遍视频 |
| `gemini-3-pro-preview` | 🧠 逻辑最强 | 适合深度查找疑难杂症（推荐） |
| `gemini-2.5-flash` | ⚖️ 平衡选择 | 兼顾速度和质量 |

### 📹 开始审计

1. 点击 "📂 导入视频"，选择你的 MP4/MOV 录屏文件
2. 选择处理模式：
   - **标准模式**：同原有逻辑
   - **高密度模式**：分段处理 5 分钟以下视频，输出更全面
3. 点击 "🔍 开始分析"
4. **等待处理**：
   - 状态栏会显示 `Uploading` -> `Processing` -> `AI Analyzing`
   - **注意**：Gemini 处理视频需要时间，请耐心等待（通常 30秒 - 2分钟）

### 📋 获取结果

1. 分析完成后，结果会显示在文本框中
2. 点击底部的 "📋 复制 (Tab格式)" 按钮
3. 打开 Excel，新建一个空白表格
4. 选中 A1 单元格，直接 **粘贴 (Ctrl+V)**
5. **魔法时刻**：数据会自动分列，整齐地进入 Excel 格子中！

---

## 🧬 进阶功能：进化记忆库

觉得 AI 还是不够懂你？你可以"调教"它！

1. 在界面中部找到 "🧬 进化记忆库" 区域
2. 点击 "➕ 添加新规则/调教AI"
3. 输入你的具体要求，例如：
   - "所有的 'Recharge' 必须统一改为 'Top-up'"
   - "不要把 'Hero' 翻译成 'Champion'"
   - "报错信息必须使用严肃的语气"

**效果**：从下一次分析开始，AI 会强制遵守这些规则。

---

## ❓ 常见问题 (FAQ)

### Q: 点击"开始分析"后程序报错或闪退？

**A1**: 检查 API Key 是否正确，且是否已开启付费/绑定项目（如果是高频使用）

**A2**: 检查网络连接（需要能连接 Google API 的网络环境）

### Q: 视频上传一直卡在 Processing？

**A**: 视频可能过大或格式生僻。建议使用压缩过的 MP4 格式，**时长控制在 3分钟以内** 效果最佳。

### Q: 安装依赖时提示 'pip' 不是内部或外部命令？

**A**: 说明 Python 环境变量没配好。请尝试使用 `py -m pip install ...` 代替 `pip install ...`

### Q: 既然是英文优化，为什么 Deep Analysis 是中文？

**A**: 这是为了方便中国开发者快速理解错误的本质。AI 用英文逻辑思考，但用中文向你汇报。

---

## 📜 迭代记录

### v1.0：可行性验证阶段
- 免费版 100万 Token ≈ 1小时视频 (建议控制在 45分钟内)
- 必须控制文件大小 < 2GB，且必须使用 Flash 系列模型以避免速率限制 (RPM) 报错

### v2.0：生产力优化
**痛点**：Markdown 表格虽然好看，但无法直接复制到 Excel 整理
**改进**：
- 修改 Prompt 输出格式为 Tab 分隔符 (`\t`)
- **效果**：实现"一键复制 -> Excel 粘贴 -> 自动分列"，大幅提升后续整理效率

### v3.0：Agent 进化 (自我学习版)
**痛点**：AI 总是记不住某些特定的项目规则（如"千分位逗号"、"特定术语"）
**改进**：
- 引入 `evolution_memory.json` (本地记忆库)
- 增加 "🧬 进化/调教" 按钮，允许用户手动输入规则
- **逻辑**：每次运行前，程序自动读取历史规则并动态注入 Prompt，实现"越用越聪明"

### v4.0：核心升级 (Gemini 3 适配)
**痛点**：默认代码使用旧模型，未能利用高级权限
**改进**：
- 全面接入 Gemini 3 Flash Preview (Google 目前最强且最快的视频理解模型)
- 保留 Gemini 2.5/2.0 作为备选方案

### v5.0：UI 探索 (赛博朋克版 - 已回滚)
**尝试**：打造全黑、霓虹风格的"指挥中心"界面
**反馈**：视觉效果酷炫，但"花里胡哨"影响办公专注度
**决策**：回滚至清爽、专业的深蓝配色 (Dark Blue)，确立"效率至上"的原则

### vFinal：极致效率版 (Ultimate Efficiency)
**核心突破**：Prompt 工程的深度优化
**策略**："English Input, Chinese Output" (英文思维，中文输出)
**原理**：利用 LLM 英文语料库更丰富的推理能力来查找逻辑漏洞和 Chinglish
**结果**：在保持输出结果中文可读性的同时，大幅提升了对"中式英语"和"语气不当"的检测敏锐度

### v10：截图双语精修（集成新功能+迭代便捷性）
- 集成截图分析功能
- 优化迭代便捷性

### v14-v24：持续优化
- v14：终极版本，基础功能完善
- v15：多语言支持（英德法土西葡俄日韩）
- v20：修复输出问题
- v22：高密度模式，支持分段处理
- v23：视频时长自动检测
- v24：提示词优化，防 AI 幻觉

---

## 🎯 模型选择

支持以下 Gemini 模型：

| 模型 | 特点 | 适用场景 |
|------|------|----------|
| `gemini-3-flash-preview` | ⚡ 速度最快 | 快速扫描 |
| `gemini-3-pro-preview` | 🧠 逻辑最强 | 深度审计（推荐） |
| `gemini-2.5-flash` | ⚖️ 平衡选择 | 日常使用 |

---

## 📁 文件说明

| 文件 | 说明 |
|------|------|
| `ui_localizer.py` | 主程序 |
| `config.json` | 配置文件 |
| `glossary.txt` | 术语表 |
| `history_db.json` | 历史审计数据库 |
| `evolution_memory.json` | 进化学习记忆 |
| `check_models.py` | 模型检查工具 |
| `history/` | 历史版本存档 |

---

*版本: v15.0 | 更新时间: 2026-02-28*