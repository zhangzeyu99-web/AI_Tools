# 📝 帮我填写 - 工作日报自动助手

> 自动化填写工作日报的智能工具，支持 AI 生成内容并自动填充到 OA 系统

## ✨ 功能特性

- 🤖 **AI 智能生成**：根据关键词，自动编写 Top5、总结和 Todo 列表
- ✍️ **自动填表**：自动登录 OA 系统，填写内容并保存
- 📅 **智能调度**：自动识别工作日/节假日/调休，休息日不打扰
- 📝 **历史记录**：自动保存所有生成记录，随时回溯
- 🔧 **高度定制**：Prompt 指令可自由修改，满足个性化需求
- 🔒 **后台静默**：支持锁屏执行，无感运行

---

## ⚠️ 注意事项与免责声明

- **先手动，后自动**：确认手动、自动任务调试无误后再开启长时任务
- **保持监控**：运行初期请务必保持人工抽检，确保流程进入稳态后再挂机
- **损失自负**：本程序仅作为效率工具提供，不保证在所有复杂环境下均能 100% 正确执行。用户需自行承担因使用本程序产生的任何直接或间接风险，开发者不对任何形式的损失负责

---

## 📦 安装步骤

### 1. 安装 Python (运行环境) (Python 3.14 以下)

由于您的电脑可能没装 Python，这是运行本软件的基础。

**下载**：
- 访问 Python 官网下载页面：https://python.org/downloads
- 点击黄色的 "Download Python 3.x.x" 按钮

**安装 (⚠️ 关键步骤)**：
1. 双击运行下载的安装包
2. **必须勾选**底部的框：**Add Python.exe to PATH** (这一步不做，后面命令都会报错！)
3. 点击中间的 "Install Now"

**验证**：
1. 按键盘 `Win + R`，输入 `cmd`，回车
2. 在黑窗口里输入 `python --version`，如果显示 Python 3.x.x，说明安装成功

### 2. 安装 Chrome 浏览器

本软件通过控制 Chrome 浏览器来自动填表。
- 请确保电脑上已安装 Google Chrome，并尽量更新到最新版

### 3. 安装 Python 依赖库

1. 按键盘 `Win + R`，输入 `cmd`，回车打开黑窗口
2. 复制以下整行命令，在黑窗口中点击鼠标右键粘贴，然后按回车：

```bash
pip install --upgrade openai google-genai selenium
```

**依赖说明**：
- `openai`: 用于连接 DeepSeek 或 Google Gemini 的大模型接口
- `selenium`: 用于模拟浏览器操作，自动登录 OA 并填写日报
- `google-genai`: 用于连接 Google Gemini (备用模型) 的核心库

如遇到报错，命令前加 `py -m ` 重试：
```bash
py -m pip install --upgrade openai google-genai selenium
```

---

## ⚙️ 软件初始化配置

首次运行软件时，需要进行一次性配置。

### 1. 启动软件

- 双击运行 `todo_gui.py` 文件
- 或者在命令行输入：`python todo_gui.py`

### 2. 账号与模型配置 (左侧面板)

**🔐 账号设置**：
- **OA账号**：输入您的公司 OA / 门户登录账号
- **OA密码**：输入登录密码 (本地加密存储，仅保存在 settings.json 中)

**🧠 模型设置 (推荐方案)**：
- **选择模型**：下拉选择 **DeepSeek** (国内直连)
- **API Key**：
  - 访问 [DeepSeek 开放平台](https://platform.deepseek.com)
  - 注册并创建一个 API Key (通常以 `sk-` 开头)
  - 将 Key 粘贴到软件的 API Key 输入框中
- **Base URL**：保持默认 (`https://api.deepseek.com`)，无需修改

注：如果切换模型，软件会自动记忆您填写的 Key，方便下次使用。

---

## 🚀 日常使用流程

### 场景 A：人工辅助模式 (看着它跑)

*重要：自动模式之前必须手动跑一次！流程跑通后即可开启自动*

适合需要确认日报内容，或者想看着浏览器自动操作的场景。

1. **填写关键词**：
   - 在 "🔑 今日工作关键词" 区域，简单罗列今天的工作
   - **示例**：`修复登录模块Bug、和产品经理对齐需求、下午组内周会`
   - **技巧**：写得越简单越好，AI 会自动润色和扩展

2. **取消静默**：
   - 不要勾选 🔒 **后台静默运行**

3. **执行**：
   - 点击底部蓝色大按钮 **⚡ 一键生成并填写**

4. **结果**：
   - 软件会自动弹出一个 Chrome 窗口，自动登录、填表、提交
   - 您可以在右侧 "📄 任务预览" 标签页看到 AI 写的内容

### 场景 B：全自动/锁屏模式 ⭐ 核心功能

*正式使用前务必测试黑屏状态下能否正常跑*

适合设置定时任务，或者电脑锁屏时自动运行。

1. **开启静默模式**：
   - 务必勾选 🔒 **后台静默运行** (支持锁屏执行)
   - **原理**：浏览器将在后台内存中运行，不需要显卡渲染界面，因此不受锁屏影响

2. **开启自动执行**：
   - 勾选 🚀 **启动后自动执行**

3. **保存配置**：
   - 点击 💾 **保存配置** 按钮

---

## ⏰ 自动化任务设置

为了实现"完全不用管"，需要配合 Windows 任务计划程序。

### 1. 打开任务计划程序

- `Win + R` 键，输入 `taskschd.msc` 回车

### 2. 创建任务

1. 点击右侧"创建基本任务"
2. **名称**：`自动写日报`
3. **常规**中勾选：
   - ☑️ 只有在用户登录时运行
   - ☑️ 使用最高权限运行

### 3. 触发器

- 选择"每天"，时间设置为上班前 (如 `9:10`)

### 4. 操作

- 选择"启动程序"
- **程序/脚本**：填写您的 python 路径

**如何查找路径**：
1. 按键盘 `Win + R`，输入 `cmd`，回车
2. 复制并粘贴下面这行命令，然后回车 (注意：这是数字 0，不是字母 O)：

```bash
py -0p
```

3. 结果：屏幕上会直接显示路径，例如：
   ```
   C:\Users\Administrator\AppData\Local\Programs\Python\Python311\python.exe
   ```
   这就是你要填在任务计划程序里的"程序/脚本"路径！

- **添加参数**：填写脚本的文件名 (如 `todo_gui.py`)
- **起始于**：**非常重要！** 必须填写脚本所在的文件夹路径 (例如 `C:\Users\Admin\Desktop\AutoReport\`)

### 5. 条件

- ☑️ 勾选 **唤醒计算机运行此任务**

### 6. 完成

- 设置完成后，确保软件里已经勾选了 🔒 **后台静默运行** 和 🚀 **启动后自动执行**

**自动化运行逻辑**：
- 每天 9:10 电脑自动运行脚本
- 脚本检测今天是工作日 → 倒计时 10 秒 → 后台无感生成并提交日报 → 退出
- 脚本检测今天是周末/节假日 → 自动停止，不执行操作
- **检测实现方式**：通过 timor.tech 联网查询中国节假日，自动识别调休

---

## 🛠️ 故障排查

### Q: 运行 pip install 时提示 "pip 不是内部或外部命令"？

**A**: 这是安装 Python 时没勾选 "Add Python to PATH" 导致的。请卸载 Python，重新安装并**务必勾选**那个框。

### Q: 软件打开后闪退？

**A**: 请通过命令行 (cmd) 运行 `python todo_gui.py`，这样可以看到报错信息。通常是因为依赖库没装好，重新运行第一阶段的 pip install 命令。

### Q: 浏览器启动报错？

**A**: 可能是 Chrome 版本太老。请更新 Chrome 浏览器。

### Q: 为什么 DeepSeek 没反应？

**A**: 检查 API Key 是否复制完整，或者您的 DeepSeek 账户余额是否充足（通常注册会送免费额度）。

---

## 🎨 高级功能：Prompt 定制

如果您觉得 AI 写的日报语气不对 (太生硬或太随意)：

1. 修改左下角的 "🤖 AI 指令模板"
2. 可以增加指令，例如：
   - "语气要谦虚一点"
   - "不使用互联网黑话，如赋能、闭环"
   - "产出内容必须包含数据指标"
3. 点击**保存配置**，下次 AI 就会按新指令生成

**长期填写建议**：按照自己的习惯调整提示词，按照固定风格生成

---

## 📜 迭代记录

### v1.0 - v11.0：基础自动化 & 稳定性
**需求**：实现自动登录 OA 系统、填写内容，并解决"保存"按钮无法点击的问题
**解决**：
- 构建 Python + Selenium 自动化框架
- 采用 JavaScript 强制点击技术，彻底修复页面遮挡导致的保存失败

### v12.0, v13.0, v16.0：智能调度 & 流程控制
**需求**：实现定时自动运行，但必须跳过周末/节假日，且流程要极速无弹窗
**解决**：
- **任务计划程序**：负责定时唤醒电脑
- **节假日 API**：脚本启动时自动识别工作日/调休补班/法定节假日
- **一键流线化**：合并生成与填写步骤，去除所有二次确认弹窗

### v12.0, v14.0：数据管理 & 交互体验
**需求**：保留操作界面以便人工确认（不希望全后台运行），且能随时查看生成过的历史记录
**解决**：
- **GUI 常驻**：任务完成后只关闭浏览器，软件窗口保留
- **倒计时机制**：启动后给予 10 秒缓冲期，允许人工取消自动执行
- **历史回溯**：新增本地日志功能，自动保存并展示每日生成内容

### v15.0：AI 内容定制
**需求**：生成的日报内容需要更灵活（如随机生成 2-4 条待办事项）
**解决**：
- **Prompt 开放编辑**：在界面新增指令模板编辑区，支持自定义语气和生成规则

---

## 🔒 安全提醒

- API Key 仅保存在本地 `settings.json`
- 建议使用环境变量或密钥管理服务
- 不要将配置文件提交到公开仓库

---

*当前版本: v2.2 | 更新日期: 2026-02-28*